import sys
import subprocess

# Get app executable
_, test_app = sys.argv

# First hundred numbers produced with a seed of 0,
mersenne_twister = [
  2357136044,
  2546248239,
  3071714933,
  3626093760,
  2588848963,
  3684848379,
  2340255427,
  3638918503,
  1819583497,
  2678185683,
  2774094101,
  1650906866,
  1879422756,
  1277901399,
  3830135878,
  243580376,
  4138900056,
  1171049868,
  1646868794,
  2051556033,
  3400433126,
  3488238119,
  2271586391,
  2061486254,
  2439732824,
  1686997841,
  3975407269,
  3590930969,
  305097549,
  1449105480,
  374217481,
  2783877012,
  86837363,
  1581585360,
  3576074995,
  4110950085,
  3342157822,
  602801999,
  3736673711,
  3736996288,
  4203133778,
  2034131043,
  3432359896,
  3439885489,
  1982038771,
  2235433757,
  3352347283,
  2915765395,
  507984782,
  3095093671,
  2748439840,
  2499755969,
  615697673,
  2308000441,
  4057322111,
  3258229280,
  2241321503,
  454869706,
  1780959476,
  2034098327,
  1136257699,
  800291326,
  3325308363,
  3165039474,
  1959150775,
  930076700,
  2441405218,
  580757632,
  80701568,
  1392175012,
  2652724277,
  642848645,
  2628931110,
  954863080,
  2649711348,
  1659957521,
  4053367119,
  3876630916,
  2928395881,
  1932520490,
  1544074682,
  2633087519,
  1877037944,
  3875557633,
  2996303169,
  426405863,
  258666409,
  4165298233,
  2863741219,
  2805215078,
  2880367735,
  734051083,
  903586222,
  1538251858,
  553734235,
  3224172416,
  1354754446,
  2610612835,
  1562125877,
  1396067212
]

proc = subprocess.Popen(
  test_app,
  stdout=subprocess.PIPE
)
stdout, stderr = proc.communicate()
exit_code = proc.wait()
if exit_code != 0:
  sys.stderr.write('Test app exit code: {0}\n'.format(exit_code))
  sys.exit(exit_code)

# Extract lines, and numbers
lines = (line.strip() for line in stdout.split('\n'))
numbers = [int(line) for line in lines if line]
if numbers != mersenne_twister:
  sys.stderr.write('Pattern does not match.\n')
  sys.exit(1)

